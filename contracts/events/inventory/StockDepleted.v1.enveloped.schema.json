{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://example.com/contracts/events/inventory/StockDepleted.v1.enveloped.schema.json",
  "title": "StockDepleted Event v1 (Enveloped)",
  "allOf": [
    {
      "$ref": "../envelope/EventEnvelope.v1.schema.json"
    },
    {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "eventName": { "const": "StockDepleted" },
        "eventVersion": { "const": 1 },
        "producer": {
          "type": "string",
          "enum": ["inventory-service", "inventory-service-go"],
          "description": "Inventory service emitting depletion events"
        },
        "partitionKey": {
          "type": "string",
          "description": "Use the productId or orderId depending on routing strategy",
          "minLength": 1
        },
        "schema": {
          "type": "string",
          "const": "contracts/events/inventory/StockDepleted.v1.payload.schema.json"
        },
        "payload": {
          "$ref": "./StockDepleted.v1.payload.schema.json"
        }
      }
    }
  ]
}
